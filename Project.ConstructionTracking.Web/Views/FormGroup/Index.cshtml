@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LayoutSite.cshtml";
    var projectId = ViewBag.ProjectId;
    var projectName = ViewBag.ProjectName;
    var FormID = ViewBag.FormID;
    var UnitFormName = ViewBag.UnitFormName;
    var unitId = ViewBag.unitId;
    var UnitCode = ViewBag.UnitCode;
    var UnitStatusName = ViewBag.UnitStatusName;
}
@model List<Project.ConstructionTracking.Web.Models.FormGroupModel>

<div class="page-wrapper">
    <!-- Page header -->
    <div class="page-header d-print-none">
        <div class="card bg-primary text-primary-fg">
            <div class="card-stamp">
                <div class="card-stamp-icon bg-white text-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-home-heart">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path d="M21 12l-9 -9l-9 9h2v7a2 2 0 0 0 2 2h6" />
                        <path d="M9 21v-6a2 2 0 0 1 2 -2h2c.39 0 .754 .112 1.061 .304" />
                        <path d="M19 21.5l2.518 -2.58a1.74 1.74 0 0 0 0 -2.413a1.627 1.627 0 0 0 -2.346 0l-.168 .172l-.168 -.172a1.627 1.627 0 0 0 -2.346 0a1.74 1.74 0 0 0 0 2.412l2.51 2.59z" />
                    </svg>
                </div>
            </div>
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div class="d-flex flex-row align-items-baseline">
                        <form asp-controller="Unitlist" asp-action="GoToByRole" method="post">
                            <input type="hidden" name="projectId" value="@projectId" />
                            <input type="hidden" name="projectName" value="@projectName" />
                            <input type="hidden" name="unitId" value="@unitId" />
                            <input type="hidden" name="UnitCode" value="@UnitCode" />
                            <input type="hidden" name="UnitStatusName" value="@UnitStatusName" />
                            <button class="status-dot bg-transparent">
                                <i class="fa-solid fa-chevron-left fa-xl" style="color: #f7f7f7;"></i>
                            </button>
                        </form>
                    </div>
                    <div class="d-block d-sm-flex align-items-baseline custom-heading">
                        <h3 class="mb-0 header-text"> @UnitFormName ( Unit : @UnitCode )</h3>
                        <div class="text-muted">
                            <h5 class="text-yellow d-block d-sm-inline ms-sm-2 mb-0">@projectName (สถานะ : @UnitStatusName)</h5>
                        </div>
                    </div>
                    <div class="align-items-right">

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Page body -->
    <div class="page-body">
        <div class="container mt-1 mb-2">
            <div class="row">
                @foreach (var item in Model)
                {
                    <div class="col-md-4">
                        <div class="card card-link card-link-pop p-3 mb-2">
                            <div class="d-flex justify-content-between">
                                <div class="d-flex flex-row align-items-center">
                                    <form asp-controller="FormCheckList" asp-action="index" method="post">
                                        <input type="hidden" name="projectId" value="@projectId" />
                                        <input type="hidden" name="projectName" value="@projectName" />
                                        <input type="hidden" name="FormID" value="@FormID" />
                                        <input type="hidden" name="UnitFormName" value="@UnitFormName" />
                                        <input type="hidden" name="unitId" value="@unitId" />
                                        <input type="hidden" name="UnitCode" value="@UnitCode" />
                                        <input type="hidden" name="UnitStatusName" value="@UnitStatusName" />
                                        <input type="hidden" name="GroupName" value="@item.GroupName" />
                                        <input type="hidden" name="GroupID" value="@item.GroupID" />
                                        <button class="status-dot bg-@item.StatusUse @(item.StatusUse == "danger" || item.StatusUse == "warning" ? "status-dot-animated" : "")">
                                            @if (item.StatusUse == "success")
                                            {
                                                <i class="fa-regular fa-circle-check"></i>
                                            }
                                            else if (item.StatusUse == "danger")
                                            {
                                                <i class="fa-regular fa-circle-xmark"></i>
                                            }
                                            else if (item.StatusUse == "warning")
                                            {
                                                <i class="fa-solid fa-file-pen"></i>
                                            }
                                            else if (item.StatusUse == "secondary")
                                            {
                                                <i class="fa-solid fa-magnifying-glass"></i>
                                            }
                                        </button>
                                    </form>
                                    <div class="ms-2 c-details">
                                        <h3 class="mb-0">@item.GroupName</h3>
                                    </div>
                                </div>
                                @if (item.LockStatusID != 0)
                                {
                                    @if (item.LockStatusID == 1)
                                    {
                                         <form action="@Url.Action("index","FormCheckList")" method="post">
                                            <button class="status-dot bg-primary">
                                                <span class="status-text"><i class="fa-solid fa-lock"></i></span>
                                            </button>
                                        </form>                                   
                                    }
                                    else if (item.LockStatusID == 4)
                                    {
                                        <form action="@Url.Action("index","FormCheckList")" method="post">
                                            <button class="status-dot bg-success">
                                                <span class="status-text"><i class="fa-solid fa-lock"></i></span>
                                            </button>
                                        </form>
                                    }
                                    else if (item.LockStatusID == 6)
                                    {
                                        <form action="@Url.Action("index","FormCheckList")" method="post">
                                            <button class="status-dot bg-primary">
                                                <span class="status-text"><i class="fa-solid fa-lock-open"></i></span>
                                            </button>
                                        </form>
                                    }
                                    else if (item.LockStatusID == 7)
                                    {
                                        <form action="@Url.Action("index","FormCheckList")" method="post">
                                            <button class="status-dot bg-danger">
                                                <span class="status-text"><i class="fa-solid fa-lock-open"></i></span>
                                            </button>
                                        </form>
                                    }
                                    else if (item.LockStatusID == 8)
                                    {
                                        <form action="@Url.Action("index","FormCheckList")" method="post">
                                            <button class="status-dot bg-success">
                                                <span class="status-text"><i class="fa-solid fa-lock-open"></i></span>
                                            </button>
                                        </form>
                                    }
                                    else if (item.LockStatusID == 9)
                                    {
                                        <form action="@Url.Action("index","FormCheckList")" method="post">
                                            <button class="status-dot bg-danger">
                                                <span class="status-text"><i class="fa-solid fa-lock-open"></i></span>
                                            </button>
                                        </form>
                                    }
                                }
                                else  
                                {
                        
                                }
                            </div>
                            <div class="mt-3">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><span class="text1">รายการทั้งหมด @item.Cnt_CheckList_All </span></li>
                                    <li class="breadcrumb-item" aria-current="page"><span class="text2">ตรวจแล้ว @item.Cnt_CheckList_Unit </span></li>
                                    <li class="breadcrumb-item" aria-current="page"><span class="text3">ไม่ผ่าน @item.Cnt_CheckList_NotPass</span></li>
                                </ol>
                            </div>
                        </div>
                    </div>
                }
@*
                <div class="col-md-4">
                    <div class="card p-3 mb-2">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex flex-row align-items-center">
                                <form action="@Url.Action("index","FormCheckList")" method="post">
                                    <button class="status-dot bg-green">
                                        <i class="fa-regular fa-circle-check"></i>
                                    </button>
                                </form>
                                <div class="ms-2 c-details">
                                    <h3 class="mb-0">ก่ออิฐ</h3>
                                </div>                               
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 mb-2">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex flex-row align-items-center">
                                <form action="@Url.Action("index","FormCheckList")" method="post">
                                    <button class="status-dot bg-green">
                                        <i class="fa-regular fa-circle-check"></i>
                                    </button>
                                </form>
                                <div class="ms-2 c-details">
                                    <h3 class="mb-0">ฝ้าภายนอกชั้นบน</h3>
                                </div>
                            </div>
                            <form action="@Url.Action("index","FormCheckList")" method="post">
                                <button class="status-dot bg-primary">
                                    <span class="status-text"><i class="fa-solid fa-lock"></i></span>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 mb-2">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex flex-row align-items-center">
                                <form action="@Url.Action("index","FormCheckList")" method="post">
                                    <button class="status-dot status-dot-animated bg-danger">
                                        <i class="fa-regular fa-circle-xmark"></i>
                                    </button>
                                </form>
                                <div class="ms-2 c-details">
                                    <h3 class="mb-0">ตั้งวงกบ</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 mb-2">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex flex-row align-items-center">
                                <form action="@Url.Action("index","FormCheckList")" method="post">
                                    <button class="status-dot status-dot-animated" style="background-color: orange;">
                                        <i class="fa-solid fa-file-pen"></i>
                                    </button>
                                </form>
                                <div class="ms-2 c-details">
                                    <h3 class="mb-0">งานท่อไฟฟ้า+ประปา</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 mb-2">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex flex-row align-items-center">
                                <form action="@Url.Action("index","FormCheckList")" method="post">
                                    <button class="status-dot" style="background-color: #C0C0C0;">
                                        <i class="fa-solid fa-magnifying-glass"></i>
                                    </button>
                                </form>
                                <div class="ms-2 c-details">
                                    <h3 class="mb-0">มุงหลังคารอบบน</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>*@
            </div>
        </div>
        <div class="container mt-1 mb-2">
            <div class="row">
                <div class="col-md-4">
                    <div class="card p-3 mb-2">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex flex-row align-items-center">
                            <div id="icon"> <i class="fa-solid fa-building-user"></i></div>
                                <div class="ms-2 c-details">
                                <h3 class="mb-0">ประเมิณคุณภาพการทำงานในงวด</h3>
                                </div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <label class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox">
                                <span class="form-check-label">A</span>
                            </label>
                            <label class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox">
                                <span class="form-check-label">B</span>
                            </label>
                            <label class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox">
                                <span class="form-check-label">C</span>
                            </label>
                            <label class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox">
                                <span class="form-check-label">D</span>
                            </label>
                        </div>
                        <div class="mt-3">
                            <label class="form-label">วิศกรผู้ควบคุมงาน</label>
                            <input type="text" class="form-control" name="example-disabled-input" placeholder="Disabled..." value="นาย สมชาย ใจดี" disabled>
                        </div>
                        <div class="card-footer">
                            <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#signatureModel">
                                ผู้รับเหมาลงนาม
                            </button>
                            <button class="btn btn-link">Save</button>
                            <button class="btn btn-primary ms-auto">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="signatureModel" tabindex="-1" aria-labelledby="signatureModelLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="signatureModelLabel">ผู้รับเหมาลงนาม</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="signature-pad">
                        <canvas id="signatureCanvas"></canvas>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="clearBtn" class="btn btn-danger mt-2">Clear</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        const canvas = document.getElementById('signatureCanvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;

        canvas.addEventListener('mousedown', () => {
            isDrawing = true;
            ctx.beginPath();
        });

        canvas.addEventListener('mousemove', (event) => {
            if (isDrawing) {
                ctx.lineTo(event.offsetX, event.offsetY);
                ctx.stroke();
            }
        });

        canvas.addEventListener('mouseup', () => {
            isDrawing = false;
        });

        canvas.addEventListener('mouseleave', () => {
            isDrawing = false;
        });

        document.getElementById('clearBtn').addEventListener('click', () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        });

        window.addEventListener('resize', resizeCanvas);

        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
        }

        resizeCanvas();
    </script>
</div>

<style>

    .status-dot {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0 auto;
        border: none;
        outline: none;
        font-size: 18px;
    }

    .card {
        border: none;
        border-radius: 10px;
    }

    .c-details span {
        font-weight: 300;
        font-size: 13px
    }

    .badge span {
        background-color: #fffbec;
        width: 60px;
        height: 25px;
        padding-bottom: 3px;
        border-radius: 5px;
        display: flex;
        color: #fed85d;
        justify-content: center;
        align-items: center
    }

    #icon {
        width: 50px;
        height: 50px;
        background-color: #eee;
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 25px
    }

    .progress {
        height: 10px;
        border-radius: 10px
    }

    .progress div {
        background-color: red
    }

    .text1 {
        font-size: 14px;
        font-weight: 600
    }

    .text2 {
        color: green
    }

    .text3 {
        color: red
    }

    .signature-pad {
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100%;
    height: 200px;
    position: relative;
    cursor: crosshair;
    }

    canvas {
        width: 100%;
        height: 100%;
    }

</style>

<script src="https://kit.fontawesome.com/21fea36ed8.js" crossorigin="anonymous"></script>
<script src="~/lib/core-ui/dist/js/tabler.min.js?1692870487" defer></script>
<script src="~/lib/core-ui/dist/js/demo.min.js?1692870487" defer></script>
<script src="~/lib/core-ui/dist/js/demo-theme.min.js?1692870487"></script>
